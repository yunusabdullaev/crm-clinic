'use client';

import { createContext, useContext, useState, useEffect, ReactNode } from 'react';

type Theme = 'light' | 'dark' | 'system';
type Language = 'en' | 'uz' | 'ru';

interface SettingsContextType {
    theme: Theme;
    setTheme: (theme: Theme) => void;
    language: Language;
    setLanguage: (lang: Language) => void;
    t: (key: string) => string;
}

const SettingsContext = createContext<SettingsContextType | undefined>(undefined);

// Translations
const translations: Record<Language, Record<string, string>> = {
    en: {
        // Navigation
        'nav.dashboard': 'Dashboard',
        'nav.patients': 'Patients',
        'nav.appointments': 'Appointments',
        'nav.visits': 'Visits',
        'nav.services': 'Services',
        'nav.staff': 'Staff',
        'nav.contracts': 'Contracts',
        'nav.expenses': 'Expenses',
        'nav.salaries': 'Salaries',
        'nav.reports': 'Reports',
        'nav.activity': 'Activity',
        'nav.settings': 'Settings',
        'nav.logout': 'Logout',
        'nav.brand': 'Medical CRM',
        // Common
        'common.save': 'Save',
        'common.cancel': 'Cancel',
        'common.delete': 'Delete',
        'common.edit': 'Edit',
        'common.create': 'Create',
        'common.add': 'Add',
        'common.search': 'Search',
        'common.loading': 'Loading...',
        'common.noData': 'No data available',
        'common.refresh': 'Refresh',
        'common.filter': 'Filter',
        'common.to': 'to',
        'common.actions': 'Actions',
        'common.name': 'Name',
        'common.email': 'Email',
        'common.phone': 'Phone',
        'common.status': 'Status',
        'common.active': 'Active',
        'common.inactive': 'Inactive',
        'common.date': 'Date',
        'common.time': 'Time',
        'common.price': 'Price',
        'common.duration': 'Duration',
        'common.notes': 'Notes',
        'common.amount': 'Amount',
        'common.select': 'Select...',
        'common.confirm': 'Are you sure?',
        'common.done': 'Done',
        // Settings
        'settings.title': 'Settings',
        'settings.appearance': 'Appearance',
        'settings.theme': 'Theme',
        'settings.themeLight': 'Light',
        'settings.themeDark': 'Dark',
        'settings.themeSystem': 'System',
        'settings.language': 'Language',
        // Login
        'login.title': 'Medical CRM',
        'login.subtitle': 'Sign in to your account',
        'login.email': 'Email',
        'login.password': 'Password',
        'login.emailPlaceholder': 'Enter your email',
        'login.passwordPlaceholder': 'Enter your password',
        'login.submit': 'Sign In',
        'login.submitting': 'Signing in...',
        // Dashboard titles
        'dashboard.title': 'Dashboard',
        'dashboard.reception': 'Reception Dashboard',
        'dashboard.doctor': 'Doctor Dashboard',
        'dashboard.boss': 'Boss Dashboard',
        'dashboard.patientsToday': 'New Patients Today',
        'dashboard.visitsToday': 'Visits Today',
        'dashboard.revenueToday': 'Revenue Today',
        // Patients
        'patients.title': 'Patients',
        'patients.add': 'Add Patient',
        'patients.search': 'Search patients...',
        'patients.firstName': 'First Name',
        'patients.lastName': 'Last Name',
        'patients.gender': 'Gender',
        'patients.male': 'Male',
        'patients.female': 'Female',
        'patients.other': 'Other',
        'patients.noPatients': 'No patients found',
        // Appointments
        'appointments.title': 'Appointments',
        'appointments.today': "Today's Appointments",
        'appointments.book': 'Book Appointment',
        'appointments.patient': 'Patient',
        'appointments.doctor': 'Doctor',
        'appointments.dateTime': 'Date & Time',
        'appointments.selectPatient': 'Select Patient...',
        'appointments.selectDoctor': 'Select Doctor...',
        'appointments.noAppointments': 'No appointments today',
        // Visits
        'visits.title': 'Visits',
        'visits.today': "Today's Visits",
        'visits.todaySchedule': "Today's Schedule",
        'visits.start': 'Start Visit',
        'visits.complete': 'Complete Visit',
        'visits.completeTitle': 'Complete Visit',
        'visits.diagnosis': 'Diagnosis',
        'visits.diagnosisPlaceholder': 'Enter diagnosis...',
        'visits.diagnosisRequired': 'Diagnosis is required',
        'visits.notesPlaceholder': 'Additional notes...',
        'visits.serviceRequired': 'At least one service is required',
        'visits.noVisits': 'No visits today',
        'visits.noAppointments': 'No appointments today',
        'visits.total': 'Total',
        'visits.toothFormula': 'Tooth Formula',
        'visits.affectedTeeth': 'Affected Teeth',
        'visits.selectAffectedTeeth': 'Mark affected teeth',
        // Services
        'services.title': 'Medical Services',
        'services.add': 'Add Service',
        'services.name': 'Name',
        'services.description': 'Description',
        'services.qty': 'Qty',
        // Payment
        'payment.type': 'Payment Type',
        'payment.cash': 'Cash',
        'payment.card': 'Card',
        'payment.discount': 'Discount',
        'payment.discountType': 'Discount Type',
        'payment.discountValue': 'Discount Value',
        'payment.noDiscount': 'No Discount',
        'payment.percentage': 'Percentage',
        'payment.fixed': 'Fixed Amount',
        // Staff
        'staff.title': 'Staff Members',
        'staff.add': 'Add Staff',
        'staff.role': 'Role',
        'staff.doctor': 'Doctor',
        'staff.receptionist': 'Receptionist',
        // Contracts
        'contracts.title': 'Doctor Contracts',
        'contracts.add': 'Add Contract',
        'contracts.selectDoctor': 'Select a doctor',
        'contracts.sharePercent': 'Share Percentage (%)',
        'contracts.startDate': 'Start Date',
        'contracts.endDate': 'End Date (optional)',
        'contracts.ongoing': 'Ongoing',
        'contracts.noContracts': 'No contracts yet.',
        // Expenses
        'expenses.title': 'Expenses',
        'expenses.add': 'Add Expense',
        'expenses.category': 'Category',
        'expenses.rent': 'Rent',
        'expenses.utilities': 'Utilities',
        'expenses.supplies': 'Supplies',
        'expenses.marketing': 'Marketing',
        'expenses.salary': 'Salary',
        'expenses.other': 'Other',
        'expenses.note': 'Note (optional)',
        'expenses.noExpenses': 'No expenses recorded yet.',
        // Salaries
        'salaries.title': 'Staff Salaries',
        'salaries.add': 'Add Salary',
        'salaries.selectStaff': 'Select staff member',
        'salaries.monthlyAmount': 'Monthly Amount ($)',
        'salaries.effectiveFrom': 'Effective From',
        'salaries.noSalaries': 'No salaries configured yet.',
        // Activity
        'activity.title': 'Doctor Activity Log',
        'activity.allDoctors': 'All Doctors',
        'activity.noLogs': 'No activity logs yet.',
        'activity.entity': 'Entity',
        'activity.details': 'Details',
        'activity.action': 'Action',
        'activity.visitStarted': 'üè• Visit Started',
        'activity.visitFinished': '‚úÖ Visit Completed',
        'activity.statusChanged': 'üìÖ Status Changed',
        // Reports
        'reports.financialReports': 'Financial Reports',
        'reports.subtitle': 'Monthly financial overview and profit analysis',
        'reports.totalRevenue': 'Total Revenue',
        'reports.doctorEarnings': 'Doctor Earnings',
        'reports.expenses': 'Total Expenses',
        'reports.salaries': 'Staff Salaries',
        'reports.grossProfit': 'Gross Profit',
        'reports.netProfit': 'Net Profit',
        'reports.revenueByDoctor': 'Revenue by Doctor',
        'reports.expensesByCategory': 'Expenses by Category',
        'reports.profitBreakdown': 'Financial Breakdown',
        'reports.additionalStats': 'Additional Statistics',
        'reports.visitsCount': 'Total Visits',
        'reports.patientsCount': 'Patients',
        'reports.totalDiscount': 'Total Discounts',
        'reports.avgPerVisit': 'Avg. per Visit',
        'reports.noData': 'No data available for the selected period',
        // Table headers
        'table.earning': 'Earning',
        'table.revenue': 'Revenue',
        'table.service': 'Service',
        // Status
        'status.scheduled': 'Scheduled',
        'status.confirmed': 'Confirmed',
        'status.in_progress': 'In Progress',
        'status.completed': 'Completed',
        'status.cancelled': 'Cancelled',
        'status.no_show': 'No Show',
        'status.started': 'Started',
        // Treatment Plans
        'treatmentPlan.title': 'Treatment Plans',
        'treatmentPlan.create': 'Create Treatment Plan',
        'treatmentPlan.planTitle': 'Plan Title',
        'treatmentPlan.planTitlePlaceholder': 'e.g., Implant Installation',
        'treatmentPlan.steps': 'Steps',
        'treatmentPlan.addStep': 'Add Step',
        'treatmentPlan.stepDescription': 'Step Description',
        'treatmentPlan.stepPlaceholder': 'e.g., Cleaning, X-Ray',
        'treatmentPlan.noPlans': 'No treatment plans yet',
        'treatmentPlan.progress': 'Progress',
        'treatmentPlan.markComplete': 'Mark as Complete',
        'treatmentPlan.pending': 'Pending',
        'treatmentPlan.completed': 'Completed',
        'treatmentPlan.inProgress': 'In Progress',
        'treatmentPlan.patientPlans': 'Patient Treatment Plans',
        'treatmentPlan.save': 'Save',
        'treatmentPlan.finish': 'Finish & Pay',
        'treatmentPlan.saved': 'Treatment plan saved. Continue next visit.',
    },
    uz: {
        // Navigation
        'nav.dashboard': 'Boshqaruv paneli',
        'nav.patients': 'Bemorlar',
        'nav.appointments': 'Uchrashuvlar',
        'nav.visits': 'Tashriflar',
        'nav.services': 'Xizmatlar',
        'nav.staff': 'Xodimlar',
        'nav.contracts': 'Shartnomalar',
        'nav.expenses': 'Xarajatlar',
        'nav.salaries': 'Maoshlar',
        'nav.reports': 'Hisobotlar',
        'nav.activity': 'Faoliyat',
        'nav.settings': 'Sozlamalar',
        'nav.logout': 'Chiqish',
        'nav.brand': 'Medical CRM',
        // Common
        'common.save': 'Saqlash',
        'common.cancel': 'Bekor qilish',
        'common.delete': "O'chirish",
        'common.edit': 'Tahrirlash',
        'common.create': 'Yaratish',
        'common.add': "Qo'shish",
        'common.search': 'Qidirish',
        'common.loading': 'Yuklanmoqda...',
        'common.noData': "Ma'lumot yo'q",
        'common.refresh': 'Yangilash',
        'common.filter': 'Filtr',
        'common.to': 'gacha',
        'common.actions': 'Amallar',
        'common.name': 'Ism',
        'common.email': 'Elektron pochta',
        'common.phone': 'Telefon',
        'common.status': 'Holat',
        'common.active': 'Faol',
        'common.inactive': 'Nofaol',
        'common.date': 'Sana',
        'common.time': 'Vaqt',
        'common.price': 'Narx',
        'common.duration': 'Davomiyligi',
        'common.notes': 'Izohlar',
        'common.amount': 'Miqdor',
        'common.select': 'Tanlang...',
        'common.confirm': 'Ishonchingiz komilmi?',
        'common.done': 'Tayyor',
        // Settings
        'settings.title': 'Sozlamalar',
        'settings.appearance': "Ko'rinish",
        'settings.theme': 'Mavzu',
        'settings.themeLight': "Yorug'",
        'settings.themeDark': "Qorong'u",
        'settings.themeSystem': 'Tizim',
        'settings.language': 'Til',
        // Login
        'login.title': 'Medical CRM',
        'login.subtitle': 'Hisobingizga kiring',
        'login.email': 'Elektron pochta',
        'login.password': 'Parol',
        'login.emailPlaceholder': 'Elektron pochtangizni kiriting',
        'login.passwordPlaceholder': 'Parolingizni kiriting',
        'login.submit': 'Kirish',
        'login.submitting': 'Kirilmoqda...',
        // Dashboard titles
        'dashboard.title': 'Boshqaruv paneli',
        'dashboard.reception': 'Registratura paneli',
        'dashboard.doctor': 'Shifokor paneli',
        'dashboard.boss': 'Rahbar paneli',
        'dashboard.patientsToday': 'Bugungi yangi bemorlar',
        'dashboard.visitsToday': 'Bugungi tashriflar',
        'dashboard.revenueToday': 'Bugungi daromad',
        // Patients
        'patients.title': 'Bemorlar',
        'patients.add': "Bemor qo'shish",
        'patients.search': 'Bemorlarni qidirish...',
        'patients.firstName': 'Ism',
        'patients.lastName': 'Familiya',
        'patients.gender': 'Jins',
        'patients.male': 'Erkak',
        'patients.female': 'Ayol',
        'patients.other': 'Boshqa',
        'patients.noPatients': 'Bemorlar topilmadi',
        // Appointments
        'appointments.title': 'Navbatlar',
        'appointments.today': 'Bugungi navbatlar',
        'appointments.book': 'Navbatga yozish',
        'appointments.patient': 'Bemor',
        'appointments.doctor': 'Shifokor',
        'appointments.dateTime': 'Sana va vaqt',
        'appointments.selectPatient': 'Bemorni tanlang...',
        'appointments.selectDoctor': 'Shifokorni tanlang...',
        'appointments.noAppointments': "Bugun navbat yo'q",
        // Visits
        'visits.title': 'Tashriflar',
        'visits.today': 'Bugungi tashriflar',
        'visits.todaySchedule': 'Bugungi jadval',
        'visits.start': 'Tashrifni boshlash',
        'visits.complete': 'Yakunlash',
        'visits.completeTitle': 'Tashrifni yakunlash',
        'visits.diagnosis': 'Tashxis',
        'visits.diagnosisPlaceholder': 'Tashxisni kiriting...',
        'visits.diagnosisRequired': 'Tashxis kiritish shart',
        'visits.notesPlaceholder': "Qo'shimcha izohlar...",
        'visits.serviceRequired': "Kamida bitta xizmat tanlash shart",
        'visits.noVisits': "Bugun tashrif yo'q",
        'visits.noAppointments': "Bugun navbat yo'q",
        'visits.total': 'Jami',
        'visits.toothFormula': 'Tish formulasi',
        'visits.affectedTeeth': 'Muammoli tishlar',
        'visits.selectAffectedTeeth': 'Muammoli tishlarni belgilang',
        // Services
        'services.title': 'Tibbiy xizmatlar',
        'services.add': "Xizmat qo'shish",
        'services.name': 'Nom',
        'services.description': 'Tavsif',
        'services.qty': 'Soni',
        // Payment
        'payment.type': "To'lov turi",
        'payment.cash': 'Naqd',
        'payment.card': 'Karta',
        'payment.discount': 'Chegirma',
        'payment.discountType': 'Chegirma turi',
        'payment.discountValue': 'Chegirma miqdori',
        'payment.noDiscount': 'Chegirmasiz',
        'payment.percentage': 'Foiz',
        'payment.fixed': 'Belgilangan summa',
        // Staff
        'staff.title': 'Xodimlar',
        'staff.add': "Xodim qo'shish",
        'staff.role': 'Lavozim',
        'staff.doctor': 'Shifokor',
        'staff.receptionist': 'Registrator',
        // Contracts
        'contracts.title': 'Shifokor shartnomalari',
        'contracts.add': "Shartnoma qo'shish",
        'contracts.selectDoctor': 'Shifokorni tanlang',
        'contracts.sharePercent': 'Ulush foizi (%)',
        'contracts.startDate': 'Boshlanish sanasi',
        'contracts.endDate': 'Tugash sanasi (ixtiyoriy)',
        'contracts.ongoing': 'Davom etmoqda',
        'contracts.noContracts': "Shartnomalar yo'q.",
        // Expenses
        'expenses.title': 'Xarajatlar',
        'expenses.add': "Xarajat qo'shish",
        'expenses.category': 'Toifa',
        'expenses.rent': 'Ijara',
        'expenses.utilities': 'Kommunal',
        'expenses.supplies': 'Materiallar',
        'expenses.marketing': 'Marketing',
        'expenses.salary': 'Maosh',
        'expenses.other': 'Boshqa',
        'expenses.note': 'Izoh (ixtiyoriy)',
        'expenses.noExpenses': "Xarajatlar hali kiritilmagan.",
        // Salaries
        'salaries.title': 'Xodimlar maoshi',
        'salaries.add': "Maosh qo'shish",
        'salaries.selectStaff': 'Xodimni tanlang',
        'salaries.monthlyAmount': 'Oylik maosh ($)',
        'salaries.effectiveFrom': 'Kuchga kirish sanasi',
        'salaries.noSalaries': "Maoshlar hali sozlanmagan.",
        // Activity
        'activity.title': 'Shifokorlar faoliyati',
        'activity.allDoctors': 'Barcha shifokorlar',
        'activity.noLogs': "Faoliyat tarixi yo'q.",
        'activity.entity': 'Obyekt',
        'activity.details': "Tafsilotlar",
        'activity.action': 'Harakat',
        'activity.visitStarted': 'üè• Tashrif boshlandi',
        'activity.visitFinished': '‚úÖ Tashrif yakunlandi',
        'activity.statusChanged': "üìÖ Holat o'zgardi",
        // Reports
        'reports.financialReports': 'Moliyaviy hisobotlar',
        'reports.subtitle': 'Oylik moliyaviy sharh va foyda tahlili',
        'reports.totalRevenue': 'Jami daromad',
        'reports.doctorEarnings': 'Shifokor ulushi',
        'reports.expenses': 'Jami xarajatlar',
        'reports.salaries': 'Xodimlar maoshi',
        'reports.grossProfit': 'Yalpi foyda',
        'reports.netProfit': 'Sof foyda',
        'reports.revenueByDoctor': "Shifokorlar bo'yicha daromad",
        'reports.expensesByCategory': "Toifalar bo'yicha xarajatlar",
        'reports.profitBreakdown': 'Moliyaviy taqsimot',
        'reports.additionalStats': "Qo'shimcha statistika",
        'reports.visitsCount': 'Jami tashriflar',
        'reports.patientsCount': 'Bemorlar',
        'reports.totalDiscount': 'Jami chegirmalar',
        'reports.avgPerVisit': "Tashrif uchun o'rtacha",
        'reports.noData': "Tanlangan davr uchun ma'lumot yo'q",
        // Table headers
        'table.earning': 'Daromad',
        'table.revenue': 'Tushum',
        'table.service': 'Xizmat',
        // Status
        'status.scheduled': 'Rejalashtirilgan',
        'status.confirmed': 'Tasdiqlangan',
        'status.in_progress': 'Jarayonda',
        'status.completed': 'Yakunlangan',
        'status.cancelled': 'Bekor qilingan',
        'status.no_show': 'Kelmadi',
        'status.started': 'Boshlangan',
        // Treatment Plans
        'treatmentPlan.title': 'Davolash Rejalari',
        'treatmentPlan.create': 'Reja Yaratish',
        'treatmentPlan.planTitle': 'Reja nomi',
        'treatmentPlan.planTitlePlaceholder': 'masalan: Implant o\'rnatish',
        'treatmentPlan.steps': 'Bosqichlar',
        'treatmentPlan.addStep': 'Bosqich qo\'shish',
        'treatmentPlan.stepDescription': 'Bosqich tavsifi',
        'treatmentPlan.stepPlaceholder': 'masalan: Tozalash, Rentgen',
        'treatmentPlan.noPlans': 'Davolash rejalari yo\'q',
        'treatmentPlan.progress': 'Jarayon',
        'treatmentPlan.markComplete': 'Bajarildi deb belgilash',
        'treatmentPlan.pending': 'Kutilmoqda',
        'treatmentPlan.completed': 'Bajarildi',
        'treatmentPlan.inProgress': 'Jarayonda',
        'treatmentPlan.patientPlans': 'Bemor davolash rejalari',
        'treatmentPlan.save': 'Saqlash',
        'treatmentPlan.finish': 'Tugatish va To\'lash',
        'treatmentPlan.saved': 'Davolash rejasi saqlandi. Keyingi tashrifda davom eting.',
    },
    ru: {
        // Navigation
        'nav.dashboard': '–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è',
        'nav.patients': '–ü–∞—Ü–∏–µ–Ω—Ç—ã',
        'nav.appointments': '–ó–∞–ø–∏—Å–∏',
        'nav.visits': '–í–∏–∑–∏—Ç—ã',
        'nav.services': '–£—Å–ª—É–≥–∏',
        'nav.staff': '–ü–µ—Ä—Å–æ–Ω–∞–ª',
        'nav.contracts': '–ö–æ–Ω—Ç—Ä–∞–∫—Ç—ã',
        'nav.expenses': '–†–∞—Å—Ö–æ–¥—ã',
        'nav.salaries': '–ó–∞—Ä–ø–ª–∞—Ç—ã',
        'nav.reports': '–û—Ç—á—ë—Ç—ã',
        'nav.activity': '–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å',
        'nav.settings': '–ù–∞—Å—Ç—Ä–æ–π–∫–∏',
        'nav.logout': '–í—ã—Ö–æ–¥',
        'nav.brand': 'Medical CRM',
        // Common
        'common.save': '–°–æ—Ö—Ä–∞–Ω–∏—Ç—å',
        'common.cancel': '–û—Ç–º–µ–Ω–∞',
        'common.delete': '–£–¥–∞–ª–∏—Ç—å',
        'common.edit': '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å',
        'common.create': '–°–æ–∑–¥–∞—Ç—å',
        'common.add': '–î–æ–±–∞–≤–∏—Ç—å',
        'common.search': '–ü–æ–∏—Å–∫',
        'common.loading': '–ó–∞–≥—Ä—É–∑–∫–∞...',
        'common.noData': '–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö',
        'common.refresh': '–û–±–Ω–æ–≤–∏—Ç—å',
        'common.filter': '–§–∏–ª—å—Ç—Ä',
        'common.to': '–¥–æ',
        'common.actions': '–î–µ–π—Å—Ç–≤–∏—è',
        'common.name': '–ò–º—è',
        'common.email': '–≠–ª. –ø–æ—á—Ç–∞',
        'common.phone': '–¢–µ–ª–µ—Ñ–æ–Ω',
        'common.status': '–°—Ç–∞—Ç—É—Å',
        'common.active': '–ê–∫—Ç–∏–≤–µ–Ω',
        'common.inactive': '–ù–µ–∞–∫—Ç–∏–≤–µ–Ω',
        'common.date': '–î–∞—Ç–∞',
        'common.time': '–í—Ä–µ–º—è',
        'common.price': '–¶–µ–Ω–∞',
        'common.duration': '–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å',
        'common.notes': '–ó–∞–º–µ—Ç–∫–∏',
        'common.amount': '–°—É–º–º–∞',
        'common.select': '–í—ã–±–µ—Ä–∏—Ç–µ...',
        'common.confirm': '–í—ã —É–≤–µ—Ä–µ–Ω—ã?',
        'common.done': '–ì–æ—Ç–æ–≤–æ',
        // Settings
        'settings.title': '–ù–∞—Å—Ç—Ä–æ–π–∫–∏',
        'settings.appearance': '–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ',
        'settings.theme': '–¢–µ–º–∞',
        'settings.themeLight': '–°–≤–µ—Ç–ª–∞—è',
        'settings.themeDark': '–¢—ë–º–Ω–∞—è',
        'settings.themeSystem': '–°–∏—Å—Ç–µ–º–Ω–∞—è',
        'settings.language': '–Ø–∑—ã–∫',
        // Login
        'login.title': 'Medical CRM',
        'login.subtitle': '–í–æ–π–¥–∏—Ç–µ –≤ —Å–≤–æ–π –∞–∫–∫–∞—É–Ω—Ç',
        'login.email': '–≠–ª. –ø–æ—á—Ç–∞',
        'login.password': '–ü–∞—Ä–æ–ª—å',
        'login.emailPlaceholder': '–í–≤–µ–¥–∏—Ç–µ —ç–ª. –ø–æ—á—Ç—É',
        'login.passwordPlaceholder': '–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å',
        'login.submit': '–í–æ–π—Ç–∏',
        'login.submitting': '–í—Ö–æ–¥...',
        // Dashboard titles
        'dashboard.title': '–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è',
        'dashboard.reception': '–ü–∞–Ω–µ–ª—å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ç—É—Ä—ã',
        'dashboard.doctor': '–ü–∞–Ω–µ–ª—å –≤—Ä–∞—á–∞',
        'dashboard.boss': '–ü–∞–Ω–µ–ª—å —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—è',
        'dashboard.patientsToday': '–ù–æ–≤—ã—Ö –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤ —Å–µ–≥–æ–¥–Ω—è',
        'dashboard.visitsToday': '–í–∏–∑–∏—Ç–æ–≤ —Å–µ–≥–æ–¥–Ω—è',
        'dashboard.revenueToday': '–í—ã—Ä—É—á–∫–∞ —Å–µ–≥–æ–¥–Ω—è',
        // Patients
        'patients.title': '–ü–∞—Ü–∏–µ–Ω—Ç—ã',
        'patients.add': '–î–æ–±–∞–≤–∏—Ç—å –ø–∞—Ü–∏–µ–Ω—Ç–∞',
        'patients.search': '–ü–æ–∏—Å–∫ –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤...',
        'patients.firstName': '–ò–º—è',
        'patients.lastName': '–§–∞–º–∏–ª–∏—è',
        'patients.gender': '–ü–æ–ª',
        'patients.male': '–ú—É–∂—Å–∫–æ–π',
        'patients.female': '–ñ–µ–Ω—Å–∫–∏–π',
        'patients.other': '–î—Ä—É–≥–æ–π',
        'patients.noPatients': '–ü–∞—Ü–∏–µ–Ω—Ç—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã',
        // Appointments
        'appointments.title': '–ó–∞–ø–∏—Å–∏',
        'appointments.today': '–ó–∞–ø–∏—Å–∏ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è',
        'appointments.book': '–ó–∞–ø–∏—Å–∞—Ç—å',
        'appointments.patient': '–ü–∞—Ü–∏–µ–Ω—Ç',
        'appointments.doctor': '–í—Ä–∞—á',
        'appointments.dateTime': '–î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è',
        'appointments.selectPatient': '–í—ã–±–µ—Ä–∏—Ç–µ –ø–∞—Ü–∏–µ–Ω—Ç–∞...',
        'appointments.selectDoctor': '–í—ã–±–µ—Ä–∏—Ç–µ –≤—Ä–∞—á–∞...',
        'appointments.noAppointments': '–ù–µ—Ç –∑–∞–ø–∏—Å–µ–π –Ω–∞ —Å–µ–≥–æ–¥–Ω—è',
        // Visits
        'visits.title': '–í–∏–∑–∏—Ç—ã',
        'visits.today': '–í–∏–∑–∏—Ç—ã —Å–µ–≥–æ–¥–Ω—è',
        'visits.todaySchedule': '–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è',
        'visits.start': '–ù–∞—á–∞—Ç—å –≤–∏–∑–∏—Ç',
        'visits.complete': '–ó–∞–≤–µ—Ä—à–∏—Ç—å',
        'visits.completeTitle': '–ó–∞–≤–µ—Ä—à–∏—Ç—å –≤–∏–∑–∏—Ç',
        'visits.diagnosis': '–î–∏–∞–≥–Ω–æ–∑',
        'visits.diagnosisPlaceholder': '–í–≤–µ–¥–∏—Ç–µ –¥–∏–∞–≥–Ω–æ–∑...',
        'visits.diagnosisRequired': '–î–∏–∞–≥–Ω–æ–∑ –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω',
        'visits.notesPlaceholder': '–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–º–µ—Ç–∫–∏...',
        'visits.serviceRequired': '–¢—Ä–µ–±—É–µ—Ç—Å—è —Ö–æ—Ç—è –±—ã –æ–¥–Ω–∞ —É—Å–ª—É–≥–∞',
        'visits.noVisits': '–ù–µ—Ç –≤–∏–∑–∏—Ç–æ–≤ —Å–µ–≥–æ–¥–Ω—è',
        'visits.noAppointments': '–ù–µ—Ç –∑–∞–ø–∏—Å–µ–π –Ω–∞ —Å–µ–≥–æ–¥–Ω—è',
        'visits.total': '–ò—Ç–æ–≥–æ',
        'visits.toothFormula': '–ó—É–±–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞',
        'visits.affectedTeeth': '–ü—Ä–æ–±–ª–µ–º–Ω—ã–µ –∑—É–±—ã',
        'visits.selectAffectedTeeth': '–û—Ç–º–µ—Ç—å—Ç–µ –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ –∑—É–±—ã',
        // Services
        'services.title': '–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ —É—Å–ª—É–≥–∏',
        'services.add': '–î–æ–±–∞–≤–∏—Ç—å —É—Å–ª—É–≥—É',
        'services.name': '–ù–∞–∑–≤–∞–Ω–∏–µ',
        'services.description': '–û–ø–∏—Å–∞–Ω–∏–µ',
        'services.qty': '–ö–æ–ª-–≤–æ',
        // Payment
        'payment.type': '–¢–∏–ø –æ–ø–ª–∞—Ç—ã',
        'payment.cash': '–ù–∞–ª–∏—á–Ω—ã–µ',
        'payment.card': '–ö–∞—Ä—Ç–∞',
        'payment.discount': '–°–∫–∏–¥–∫–∞',
        'payment.discountType': '–¢–∏–ø —Å–∫–∏–¥–∫–∏',
        'payment.discountValue': '–†–∞–∑–º–µ—Ä —Å–∫–∏–¥–∫–∏',
        'payment.noDiscount': '–ë–µ–∑ —Å–∫–∏–¥–∫–∏',
        'payment.percentage': '–ü—Ä–æ—Ü–µ–Ω—Ç',
        'payment.fixed': '–§–∏–∫—Å. —Å—É–º–º–∞',
        // Staff
        'staff.title': '–°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏',
        'staff.add': '–î–æ–±–∞–≤–∏—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞',
        'staff.role': '–†–æ–ª—å',
        'staff.doctor': '–í—Ä–∞—á',
        'staff.receptionist': '–†–µ–≥–∏—Å—Ç—Ä–∞—Ç–æ—Ä',
        // Contracts
        'contracts.title': '–ö–æ–Ω—Ç—Ä–∞–∫—Ç—ã –≤—Ä–∞—á–µ–π',
        'contracts.add': '–î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Ç—Ä–∞–∫—Ç',
        'contracts.selectDoctor': '–í—ã–±–µ—Ä–∏—Ç–µ –≤—Ä–∞—á–∞',
        'contracts.sharePercent': '–î–æ–ª—è (%)',
        'contracts.startDate': '–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞',
        'contracts.endDate': '–î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è (–æ–ø—Ü.)',
        'contracts.ongoing': '–ë–µ—Å—Å—Ä–æ—á–Ω—ã–π',
        'contracts.noContracts': '–ö–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç.',
        // Expenses
        'expenses.title': '–†–∞—Å—Ö–æ–¥—ã',
        'expenses.add': '–î–æ–±–∞–≤–∏—Ç—å —Ä–∞—Å—Ö–æ–¥',
        'expenses.category': '–ö–∞—Ç–µ–≥–æ—Ä–∏—è',
        'expenses.rent': '–ê—Ä–µ–Ω–¥–∞',
        'expenses.utilities': '–ö–æ–º–º—É–Ω–∞–ª—å–Ω—ã–µ',
        'expenses.supplies': '–ú–∞—Ç–µ—Ä–∏–∞–ª—ã',
        'expenses.marketing': '–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥',
        'expenses.salary': '–ó–∞—Ä–ø–ª–∞—Ç–∞',
        'expenses.other': '–î—Ä—É–≥–æ–µ',
        'expenses.note': '–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ (–æ–ø—Ü.)',
        'expenses.noExpenses': '–†–∞—Å—Ö–æ–¥–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç.',
        // Salaries
        'salaries.title': '–ó–∞—Ä–ø–ª–∞—Ç—ã —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤',
        'salaries.add': '–î–æ–±–∞–≤–∏—Ç—å –∑–∞—Ä–ø–ª–∞—Ç—É',
        'salaries.selectStaff': '–í—ã–±–µ—Ä–∏—Ç–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞',
        'salaries.monthlyAmount': '–ú–µ—Å—è—á–Ω–∞—è —Å—É–º–º–∞ ($)',
        'salaries.effectiveFrom': '–î–µ–π—Å—Ç–≤—É–µ—Ç —Å',
        'salaries.noSalaries': '–ó–∞—Ä–ø–ª–∞—Ç—ã –ø–æ–∫–∞ –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã.',
        // Activity
        'activity.title': '–ñ—É—Ä–Ω–∞–ª –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –≤—Ä–∞—á–µ–π',
        'activity.allDoctors': '–í—Å–µ –≤—Ä–∞—á–∏',
        'activity.noLogs': '–ñ—É—Ä–Ω–∞–ª –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø—É—Å—Ç.',
        'activity.entity': '–û–±—ä–µ–∫—Ç',
        'activity.details': '–î–µ—Ç–∞–ª–∏',
        'activity.action': '–î–µ–π—Å—Ç–≤–∏–µ',
        'activity.visitStarted': 'üè• –í–∏–∑–∏—Ç –Ω–∞—á–∞—Ç',
        'activity.visitFinished': '‚úÖ –í–∏–∑–∏—Ç –∑–∞–≤–µ—Ä—à—ë–Ω',
        'activity.statusChanged': 'üìÖ –°—Ç–∞—Ç—É—Å –∏–∑–º–µ–Ω—ë–Ω',
        // Reports
        'reports.financialReports': '–§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –æ—Ç—á—ë—Ç—ã',
        'reports.subtitle': '–ï–∂–µ–º–µ—Å—è—á–Ω—ã–π —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–π –æ–±–∑–æ—Ä –∏ –∞–Ω–∞–ª–∏–∑ –ø—Ä–∏–±—ã–ª–∏',
        'reports.totalRevenue': '–û–±—â–∏–π –¥–æ—Ö–æ–¥',
        'reports.doctorEarnings': '–ó–∞—Ä–∞–±–æ—Ç–æ–∫ –≤—Ä–∞—á–µ–π',
        'reports.expenses': '–û–±—â–∏–µ —Ä–∞—Å—Ö–æ–¥—ã',
        'reports.salaries': '–ó–∞—Ä–ø–ª–∞—Ç—ã –ø–µ—Ä—Å–æ–Ω–∞–ª–∞',
        'reports.grossProfit': '–í–∞–ª–æ–≤–∞—è –ø—Ä–∏–±—ã–ª—å',
        'reports.netProfit': '–ß–∏—Å—Ç–∞—è –ø—Ä–∏–±—ã–ª—å',
        'reports.revenueByDoctor': '–î–æ—Ö–æ–¥ –ø–æ –≤—Ä–∞—á–∞–º',
        'reports.expensesByCategory': '–†–∞—Å—Ö–æ–¥—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º',
        'reports.profitBreakdown': '–§–∏–Ω–∞–Ω—Å–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞',
        'reports.additionalStats': '–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞',
        'reports.visitsCount': '–í—Å–µ–≥–æ –≤–∏–∑–∏—Ç–æ–≤',
        'reports.patientsCount': '–ü–∞—Ü–∏–µ–Ω—Ç—ã',
        'reports.totalDiscount': '–í—Å–µ–≥–æ —Å–∫–∏–¥–æ–∫',
        'reports.avgPerVisit': '–°—Ä–µ–¥–Ω–∏–π —á–µ–∫',
        'reports.noData': '–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥',
        // Table headers
        'table.earning': '–ó–∞—Ä–∞–±–æ—Ç–æ–∫',
        'table.revenue': '–í—ã—Ä—É—á–∫–∞',
        'table.service': '–£—Å–ª—É–≥–∞',
        // Status
        'status.scheduled': '–ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ',
        'status.confirmed': '–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ',
        'status.in_progress': '–í –ø—Ä–æ—Ü–µ—Å—Å–µ',
        'status.completed': '–ó–∞–≤–µ—Ä—à–µ–Ω–æ',
        'status.cancelled': '–û—Ç–º–µ–Ω–µ–Ω–æ',
        'status.no_show': '–ù–µ –ø—Ä–∏—à—ë–ª',
        'status.started': '–ù–∞—á–∞—Ç–æ',
        // Treatment Plans
        'treatmentPlan.title': '–ü–ª–∞–Ω—ã –ª–µ—á–µ–Ω–∏—è',
        'treatmentPlan.create': '–°–æ–∑–¥–∞—Ç—å –ø–ª–∞–Ω',
        'treatmentPlan.planTitle': '–ù–∞–∑–≤–∞–Ω–∏–µ –ø–ª–∞–Ω–∞',
        'treatmentPlan.planTitlePlaceholder': '–Ω–∞–ø—Ä.: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏–º–ø–ª–∞–Ω—Ç–∞',
        'treatmentPlan.steps': '–≠—Ç–∞–ø—ã',
        'treatmentPlan.addStep': '–î–æ–±–∞–≤–∏—Ç—å —ç—Ç–∞–ø',
        'treatmentPlan.stepDescription': '–û–ø–∏—Å–∞–Ω–∏–µ —ç—Ç–∞–ø–∞',
        'treatmentPlan.stepPlaceholder': '–Ω–∞–ø—Ä.: –ß–∏—Å—Ç–∫–∞, –†–µ–Ω—Ç–≥–µ–Ω',
        'treatmentPlan.noPlans': '–ù–µ—Ç –ø–ª–∞–Ω–æ–≤ –ª–µ—á–µ–Ω–∏—è',
        'treatmentPlan.progress': '–ü—Ä–æ–≥—Ä–µ—Å—Å',
        'treatmentPlan.markComplete': '–û—Ç–º–µ—Ç–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–º',
        'treatmentPlan.pending': '–û–∂–∏–¥–∞–µ—Ç',
        'treatmentPlan.completed': '–í—ã–ø–æ–ª–Ω–µ–Ω–æ',
        'treatmentPlan.inProgress': '–í –ø—Ä–æ—Ü–µ—Å—Å–µ',
        'treatmentPlan.patientPlans': '–ü–ª–∞–Ω—ã –ª–µ—á–µ–Ω–∏—è –ø–∞—Ü–∏–µ–Ω—Ç–∞',
        'treatmentPlan.save': '–°–æ—Ö—Ä–∞–Ω–∏—Ç—å',
        'treatmentPlan.finish': '–ó–∞–≤–µ—Ä—à–∏—Ç—å –∏ –æ–ø–ª–∞—Ç–∏—Ç—å',
        'treatmentPlan.saved': '–ü–ª–∞–Ω –ª–µ—á–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—ë–Ω. –ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ –Ω–∞ —Å–ª–µ–¥—É—é—â–µ–º –≤–∏–∑–∏—Ç–µ.',
    },
};

export function SettingsProvider({ children }: { children: ReactNode }) {
    const [theme, setThemeState] = useState<Theme>('light');
    const [language, setLanguageState] = useState<Language>('en');
    const [mounted, setMounted] = useState(false);

    useEffect(() => {
        setMounted(true);
        // Load saved settings
        const savedTheme = localStorage.getItem('theme') as Theme;
        const savedLang = localStorage.getItem('language') as Language;
        if (savedTheme) setThemeState(savedTheme);
        if (savedLang) setLanguageState(savedLang);
    }, []);

    useEffect(() => {
        if (!mounted) return;

        // Apply theme
        const root = document.documentElement;
        root.classList.remove('light', 'dark');

        if (theme === 'system') {
            const systemTheme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
            root.classList.add(systemTheme);
        } else {
            root.classList.add(theme);
        }

        localStorage.setItem('theme', theme);
    }, [theme, mounted]);

    const setTheme = (newTheme: Theme) => {
        setThemeState(newTheme);
    };

    const setLanguage = (lang: Language) => {
        setLanguageState(lang);
        localStorage.setItem('language', lang);
    };

    const t = (key: string): string => {
        return translations[language][key] || key;
    };

    if (!mounted) {
        return null;
    }

    return (
        <SettingsContext.Provider value={{ theme, setTheme, language, setLanguage, t }}>
            {children}
        </SettingsContext.Provider>
    );
}

export function useSettings() {
    const context = useContext(SettingsContext);
    if (!context) {
        throw new Error('useSettings must be used within a SettingsProvider');
    }
    return context;
}
